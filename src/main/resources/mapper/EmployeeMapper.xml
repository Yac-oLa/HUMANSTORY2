<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kosta.humanstory.mapper.EmployeeMapper">

    <select id="getList" resultType="com.kosta.humanstory.domain.EmployeeVO">
        select  * from employee
    </select>

<!--


    <sql id="criteria">
        <trim prefix="(" suffix=") AND" prefixOverrides="OR">
            <foreach collection="typeArr">
                <trim prefix="OR">
                    <choose>
                        <when test="type == 'T'.toString()"> empNum like '%'||#{keyword}||'%' </when>
                        <when test="type == 'C'.toString()"> empName like '%'||#{keyword}||'%' </when>
                        <when test="type == 'W'.toString()"> deptName like '%'||#{keyword}||'%' </when>
                    </choose>
                </trim>
            </foreach>
        </trim>
    </sql>

  -->
<!--

    <select id="getListWithPaging"
            resultType="org.hs.domain.EmployeeVO">
        <![CDATA[
	SELECT
		empNum,empName,pw,job,phoneNum,hireDate,annualLeaveNum,workdate,birthdate
	FROM
		(
			select
				rownum rn,empNum,empName, pw,job,phoneNum,hireDate,annualLeaveNum,workdate,birthdate
			FROM EMPLOYEE
			where
	]]>
        <include refid="criteria" />
        <![CDATA[
             rownum <= #{emppageNum}*#{empamount}
         )
         WHERE rn > (#{emppageNum}-1)*#{empamount}

      ]]>
    </select>
-->


    <insert id="insertEmpInfo">
        INSERT INTO employee (empNum, empName, pw, job,
                              phoneNum,hireDate,
                              annualLeaveNum,workDate,birthDate, adminNum,
                              authNum, deptNum)
        VALUES (empNum_seq.NEXTVAL, #{empName},#{pw}, #{job},
                #{phoneNum},#{hireDate}, #{annualLeaveNum}, #{workDate},#{birthDate},
                #{adminNum}, #{authNum}, #{deptNum})
    </insert>


    <select id="read" parameterType="String">
        select * from employee where empNum=#{empNum}
    </select>
<!--

    <select id="authread" resultMap="managerMap">

        SELECT
            e.empNum, e.EMPNAME, e.pw, e.enabled, e.email , ea.auth
        FROM Employee e
                 JOIN EMPLOYEE_AUTH ea ON e.empNum=ea.empNum
        where e.empNum=#{empNum}

    </select>
-->

    <update id="update">
        update employee set
            empName=#{empName},
            pw=#{pw},
            job=#{job},
            phoneNum=#{phoneNum},
            hireDate=#{hireDate},
            annualLeaveNum=#{annualLeaveNum},
            workDate=#{workDate},
            birthDate=#{birthDate},
            adminNum=#{adminNum},
            authNum=#{authNum},
            deptNum=#{deptNum}

        where empNum=#{empNum}
    </update>

<!--    <select id="empEmailSend" resultType="com.kosta.humanstory.domain.EmployeeVO">-->
<!--        select *from employee where annualLeaveNum>0-->
<!--    </select>-->

    <delete id="delete" parameterType="String">
        delete employee where empNum=#{empNum}
    </delete>
<!--

    <delete id="authdelete">
        delete employee_auth where empNum=#{empNum}
    </delete>
-->

</mapper>


